{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Documents\\\\htm_fe\\\\src\\\\layouts\\\\RoundBase\\\\Host\\\\HostQuestionBoxRound4.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { sendSelectedCell, sendCellColor } from '../../../components/services';\nimport { useSearchParams } from 'react-router-dom';\nimport { usePlayer } from '../../../context/playerContext';\nimport { useTimeStart } from '../../../context/timeListenerContext';\nimport { resetBuzz } from '../../../components/services';\nimport { useSounds } from '../../../context/soundContext';\nimport { useGameListeners } from '../../../hooks/useListener';\nimport GameGrid from '../../../components/ui/GameGrid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst exampleGrid = [['!', '', '?', '', '!'], ['', '?', '!', '', '?'], ['?', '', '', '!', '?'], ['!', '?', '', '', '!'], ['?', '!', '', '?', '']];\n\n// Example questions for testing\nconst exampleQuestions = ['Question 1', 'Question 2', 'Question 3', 'Question 4', 'Question 5', 'Question 6', 'Question 7', 'Question 8', 'Question 9', 'Question 10', 'Question 11', 'Question 12', 'Question 13', 'Question 14', 'Question 15', 'Question 16', 'Question 17', 'Question 18', 'Question 19', 'Question 20', 'Question 21', 'Question 22', 'Question 23', 'Question 24', 'Question 25'];\nconst HostQuestionBoxRound4 = ({\n  initialGrid,\n  questions,\n  isSpectator,\n  isHost = false\n}) => {\n  _s();\n  function generateRandomGrid() {\n    const size = 5;\n    const totalCells = size * size; // 25\n    const symbols = [\"\", \"!\", \"?\"];\n\n    // Assign counts of 8, 8, 9 to symbols randomly\n    const counts = [8, 8, 9];\n    // Shuffle counts\n    for (let i = counts.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [counts[i], counts[j]] = [counts[j], counts[i]];\n    }\n\n    // Create symbol array\n    let symbolArray = [];\n    for (let i = 0; i < symbols.length; i++) {\n      for (let j = 0; j < counts[i]; j++) {\n        symbolArray.push(symbols[i]);\n      }\n    }\n\n    // Shuffle array\n    for (let i = symbolArray.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [symbolArray[i], symbolArray[j]] = [symbolArray[j], symbolArray[i]];\n    }\n\n    // Create 5x5 grid, replace undefined/null with \"\"\n    let grid = [];\n    let index = 0;\n    for (let i = 0; i < size; i++) {\n      let row = [];\n      for (let j = 0; j < size; j++) {\n        const value = index < symbolArray.length ? symbolArray[index++] : \"\";\n        row.push(value);\n      }\n      grid.push(row);\n    }\n\n    // Ensure each row has at least one \"!\" or \"?\"\n    for (let i = 0; i < size; i++) {\n      const hasNonEmpty = grid[i].some(cell => cell === \"!\" || cell === \"?\");\n      if (!hasNonEmpty) {\n        // Find a row with multiple \"!\" or \"?\" to swap\n        let donorRow = -1;\n        let donorCol = -1;\n        for (let r = 0; r < size; r++) {\n          if (r === i) continue;\n          const nonEmptyCount = grid[r].filter(cell => cell === \"!\" || cell === \"?\").length;\n          if (nonEmptyCount > 1) {\n            for (let c = 0; c < size; c++) {\n              if (grid[r][c] === \"!\" || grid[r][c] === \"?\") {\n                donorRow = r;\n                donorCol = c;\n                break;\n              }\n            }\n            if (donorRow !== -1) break;\n          }\n        }\n        if (donorRow !== -1) {\n          // Swap with an empty cell in the target row\n          for (let c = 0; c < size; c++) {\n            if (grid[i][c] === \"\") {\n              [grid[i][c], grid[donorRow][donorCol]] = [grid[donorRow][donorCol], grid[i][c]];\n              break;\n            }\n          }\n        } else {\n          // Place \"!\" in an empty cell and adjust elsewhere\n          for (let c = 0; c < size; c++) {\n            if (grid[i][c] === \"\") {\n              grid[i][c] = \"!\";\n              // Replace a \"!\" elsewhere with \"\"\n              for (let r = 0; r < size; r++) {\n                if (r === i) continue;\n                for (let c2 = 0; c2 < size; c2++) {\n                  if (grid[r][c2] === \"!\") {\n                    grid[r][c2] = \"\";\n                    break;\n                  }\n                }\n                if (grid[r].some(cell => cell === \"\")) break;\n              }\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    // Verify counts (8, 8, 9)\n    const finalCounts = {\n      \"\": 0,\n      \"!\": 0,\n      \"?\": 0\n    };\n    for (const row of grid) {\n      for (const cell of row) {\n        finalCounts[cell]++;\n      }\n    }\n    const countValues = Object.values(finalCounts).sort((a, b) => a - b);\n    if (countValues[0] !== 8 || countValues[1] !== 8 || countValues[2] !== 9) {\n      // Adjust counts by swapping to achieve 8, 8, 9\n      let targetCounts = {\n        \"\": 8,\n        \"!\": 8,\n        \"?\": 9\n      };\n      // Randomly assign 8, 8, 9 to symbols\n      const tempCounts = [8, 8, 9];\n      const tempSymbols = [...symbols];\n      for (let i = tempCounts.length - 1; i >= 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        targetCounts[tempSymbols[j]] = tempCounts[i];\n        tempSymbols.splice(j, 1);\n      }\n\n      // Adjust grid to match target counts\n      for (let i = 0; i < size; i++) {\n        for (let j = 0; j < size; j++) {\n          if (finalCounts[grid[i][j]] > targetCounts[grid[i][j]]) {\n            // Find a cell to swap with a symbol that needs more\n            for (const sym of symbols) {\n              if (finalCounts[sym] < targetCounts[sym]) {\n                grid[i][j] = sym;\n                finalCounts[grid[i][j]]--;\n                finalCounts[sym]++;\n                break;\n              }\n            }\n          }\n        }\n      }\n    }\n    return grid;\n  }\n  const handleSuffleGrid = () => {\n    console.log(\"start generating grid\");\n    const newGrid = generateRandomGrid();\n    console.log(\"newGrid\", newGrid);\n    setGrid(newGrid);\n    setInitialGrid(newGrid);\n  };\n  const colorMap = {\n    red: '#FF0000',\n    green: '#00FF00',\n    blue: '#0000FF',\n    yellow: '#FFFF00'\n  };\n  const [grid, setGrid] = useState([[]]);\n  const sounds = useSounds();\n  const {\n    startTimer,\n    timeLeft,\n    setTimeLeft\n  } = useTimeStart();\n  const [selectedQuestion, setSelectedQuestion] = useState(null);\n  const [currentQuestion, setCurrentQuestion] = useState(\"\");\n  const [correctAnswer, setCorrectAnswer] = useState(\"\");\n  const [gridColors, setGridColors] = useState(Array(5).fill(null).map(() => Array(5).fill('#FFFFFF')) // Default grid colors are white\n  );\n  const [menu, setMenu] = useState({\n    visible: false\n  });\n  const [selectedCell, setSelectedCell] = useState(null);\n  const menuRef = useRef(null);\n  const [searchParams] = useSearchParams();\n  const roomId = searchParams.get(\"roomId\") || \"4\";\n  const {\n    setEasyQuestionNumber,\n    setMediumQuestionNumber,\n    setHardQuestionNumber,\n    setLevel,\n    animationKey,\n    setAnimationKey,\n    setInitialGrid\n  } = usePlayer();\n  const [buzzedPlayer, setBuzzedPlayer] = useState(\"\");\n  const [staredPlayer, setStaredPlayer] = useState(\"\");\n  const [showModal, setShowModal] = useState(false); // State for modal visibility\n  const isInitialTimerMount = useRef(false);\n  useGameListeners({\n    roomId,\n    setBuzzedPlayer,\n    setStaredPlayer,\n    setShowModal,\n    setCorrectAnswer,\n    setCurrentQuestion,\n    setGridColors,\n    setSelectedCell,\n    sounds,\n    round: \"4\",\n    startTimer\n  });\n  useEffect(() => {\n    if (initialGrid) {\n      setGrid(initialGrid);\n      setInitialGrid(initialGrid);\n    }\n  }, []);\n  useEffect(() => {\n    console.log(\"timeLeft\", timeLeft);\n    if (isInitialTimerMount.current) {\n      isInitialTimerMount.current = false;\n      return;\n    }\n    if (timeLeft === 0) {\n      setAnimationKey(prev => prev + 1);\n    }\n  }, [timeLeft]);\n\n  // const isInitialMount = useRef(false)\n  // useEffect(() => {\n  //     const unsubscribe = listenToTimeStart(roomId, async () => {\n\n  //         // Skip the timer setting on the first mount, but allow future calls to run\n  //         if (isInitialMount.current) {\n  //             isInitialMount.current = false;\n  //             return;\n  //         }\n  //         startTimer(15)\n  //         return () => {\n  //             unsubscribe();\n\n  //         };\n  //     })\n\n  // }, [])\n\n  const handleCloseModal = () => {\n    setShowModal(false);\n    // Optionally clear buzzedPlayer if you want to reset it\n    setBuzzedPlayer(\"\");\n    if (isHost) {\n      resetBuzz(roomId);\n    }\n  };\n  // Function to handle cell click (only for host)\n  const handleCellClick = (row, col) => {\n    if (!isHost) return; // Prevent non-host users from interacting\n    setMenu({\n      visible: true,\n      rowIndex: row,\n      colIndex: col\n    });\n  };\n\n  // Function to handle menu actions\n  const handleMenuAction = (action, row, col) => {\n    if (action === 'select') {\n      if (initialGrid[row][col] == \"\") {\n        setLevel(\"Dễ\");\n      }\n      if (initialGrid[row][col] == \"!\") {\n        setLevel(\"Trung bình\");\n      }\n      if (initialGrid[row][col] == \"?\") {\n        setLevel(\"Khó\");\n      }\n      sendSelectedCell(roomId, col.toString(), row.toString());\n      const questionIndex = row * 5 + col; // Calculate question index from grid position\n      if (questions[questionIndex]) {\n        setSelectedQuestion(questions[questionIndex]);\n        setGridColors(prev => {\n          const newGrid = prev.map(rowArray => [...rowArray]);\n          // Reset the previously selected cell to white, if it exists and wasn't colored otherwise\n          if (selectedCell) {\n            const {\n              row: prevRow,\n              col: prevCol\n            } = selectedCell;\n            // Only reset if the cell is still light yellow (i.e., not changed by color buttons)\n            if (newGrid[prevRow][prevCol] === '#FFFF99') {\n              newGrid[prevRow][prevCol] = '#FFFFFF';\n            }\n          }\n          // Set the current cell to light yellow\n          newGrid[row][col] = '#FFFF99'; // Light yellow\n          return newGrid;\n        });\n        // Update the selected cell\n        setSelectedCell({\n          row,\n          col\n        });\n      }\n    } else {\n      sendCellColor(roomId, col.toString(), row.toString(), action);\n      // Set the cell color based on the selected action\n\n      setGridColors(prev => {\n        const newGrid = prev.map(rowArray => [...rowArray]);\n        newGrid[row][col] = colorMap[action];\n        return newGrid;\n      });\n      setGridColors(prev => {\n        const newGrid = prev.map(rowArray => [...rowArray]);\n        newGrid[row][col] = colorMap[action];\n        return newGrid;\n      });\n      // If the cell was previously selected, clear the selection\n      if (selectedCell && selectedCell.row === row && selectedCell.col === col) {\n        setSelectedCell(null);\n      }\n    }\n    setMenu({\n      visible: false\n    }); // Close the menu\n  };\n  const lastBuzzedPlayerRef = useRef(null);\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\n        setMenu({\n          visible: false\n        });\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col items-center bg-slate-800/80 backdrop-blur-sm rounded-2xl border border-blue-400/30 shadow-2xl p-6 mb-4 w-full max-w-3xl mx-auto min-h-[470px]\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-bold text-cyan-200 mb-2 text-center drop-shadow\",\n      children: currentQuestion || \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 13\n    }, this), correctAnswer && /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl font-semibold text-green-300 mb-4 text-center drop-shadow\",\n      children: correctAnswer\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(GameGrid, {\n      initialGrid: grid,\n      gridColors: gridColors,\n      menu: menu,\n      isHost: true,\n      isSpectator: isSpectator,\n      showModal: showModal,\n      buzzedPlayer: buzzedPlayer,\n      staredPlayer: staredPlayer,\n      menuRef: menuRef,\n      onCellClick: handleCellClick,\n      onMenuAction: handleMenuAction,\n      onCloseModal: handleCloseModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 381,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex gap-2 mt-4 w-full\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          handleSuffleGrid();\n        },\n        className: \"bg-indigo-600 hover:bg-indigo-700 text-white p-2 flex-1 rounded-md whitespace-nowrap\",\n        children: \"X\\xE1o tr\\u1ED9n h\\xE0ng ngang\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 370,\n    columnNumber: 9\n  }, this);\n};\n_s(HostQuestionBoxRound4, \"I+EtjZCmI5H4s4AuFxSkQJBaR40=\", false, function () {\n  return [useSounds, useTimeStart, useSearchParams, usePlayer, useGameListeners];\n});\n_c = HostQuestionBoxRound4;\nexport default HostQuestionBoxRound4;\nvar _c;\n$RefreshReg$(_c, \"HostQuestionBoxRound4\");","map":{"version":3,"names":["React","useState","useEffect","useRef","sendSelectedCell","sendCellColor","useSearchParams","usePlayer","useTimeStart","resetBuzz","useSounds","useGameListeners","GameGrid","jsxDEV","_jsxDEV","exampleGrid","exampleQuestions","HostQuestionBoxRound4","initialGrid","questions","isSpectator","isHost","_s","generateRandomGrid","size","totalCells","symbols","counts","i","length","j","Math","floor","random","symbolArray","push","grid","index","row","value","hasNonEmpty","some","cell","donorRow","donorCol","r","nonEmptyCount","filter","c","c2","finalCounts","countValues","Object","values","sort","a","b","targetCounts","tempCounts","tempSymbols","splice","sym","handleSuffleGrid","console","log","newGrid","setGrid","setInitialGrid","colorMap","red","green","blue","yellow","sounds","startTimer","timeLeft","setTimeLeft","selectedQuestion","setSelectedQuestion","currentQuestion","setCurrentQuestion","correctAnswer","setCorrectAnswer","gridColors","setGridColors","Array","fill","map","menu","setMenu","visible","selectedCell","setSelectedCell","menuRef","searchParams","roomId","get","setEasyQuestionNumber","setMediumQuestionNumber","setHardQuestionNumber","setLevel","animationKey","setAnimationKey","buzzedPlayer","setBuzzedPlayer","staredPlayer","setStaredPlayer","showModal","setShowModal","isInitialTimerMount","round","current","prev","handleCloseModal","handleCellClick","col","rowIndex","colIndex","handleMenuAction","action","toString","questionIndex","rowArray","prevRow","prevCol","lastBuzzedPlayerRef","handleClickOutside","event","contains","target","document","addEventListener","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onCellClick","onMenuAction","onCloseModal","onClick","_c","$RefreshReg$"],"sources":["C:/Users/ASUS/Documents/htm_fe/src/layouts/RoundBase/Host/HostQuestionBoxRound4.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport Play from '../../Play';\r\nimport { RoundBase } from '../../../type';\r\nimport { sendSelectedCell, sendCellColor } from '../../../components/services';\r\nimport { useSearchParams } from 'react-router-dom';\r\nimport { usePlayer } from '../../../context/playerContext';\r\nimport { deletePath, listenToTimeStart, listenToSound, listenToQuestions, listenToSelectedCell, listenToCellColor, listenToAnswers, listenToBuzzing, listenToStar } from '../../../services/firebaseServices';\r\nimport { useTimeStart } from '../../../context/timeListenerContext';\r\nimport { resetBuzz } from '../../../components/services';\r\nimport { useSounds } from '../../../context/soundContext';\r\nimport { useGameListeners } from '../../../hooks/useListener';\r\nimport GameGrid from '../../../components/ui/GameGrid';\r\ninterface QuestionComponentProps {\r\n    initialGrid: string[][]; // 5x5 grid (can be passed from parent or generated)\r\n    questions: string[]; // Array of questions for testing\r\n    isSpectator?: boolean; // Indicates whether the user is a spectator\r\n    isHost?: boolean; // Indicates whether the user is the host\r\n}\r\ninterface GameGridProps {\r\n    initialGrid: string[][];\r\n    gridColors: string[][];\r\n    menu: { visible: boolean; rowIndex?: number; colIndex?: number };\r\n    isSpectator?: boolean;\r\n    showModal: boolean;\r\n    menuRef: React.RefObject<HTMLDivElement | null>;\r\n    onCellClick: (row: number, col: number) => void;\r\n    onMenuAction: (action: 'select' | 'red' | 'green' | 'blue' | 'yellow', row: number, col: number) => void;\r\n    onCloseModal: () => void;\r\n}\r\nconst exampleGrid = [\r\n    ['!', '', '?', '', '!'],\r\n    ['', '?', '!', '', '?'],\r\n    ['?', '', '', '!', '?'],\r\n    ['!', '?', '', '', '!'],\r\n    ['?', '!', '', '?', ''],\r\n];\r\n\r\n// Example questions for testing\r\nconst exampleQuestions = [\r\n    'Question 1', 'Question 2', 'Question 3', 'Question 4', 'Question 5',\r\n    'Question 6', 'Question 7', 'Question 8', 'Question 9', 'Question 10',\r\n    'Question 11', 'Question 12', 'Question 13', 'Question 14', 'Question 15',\r\n    'Question 16', 'Question 17', 'Question 18', 'Question 19', 'Question 20',\r\n    'Question 21', 'Question 22', 'Question 23', 'Question 24', 'Question 25',\r\n];\r\n\r\nconst HostQuestionBoxRound4: React.FC<QuestionComponentProps> = ({\r\n    initialGrid,\r\n    questions,\r\n    isSpectator,\r\n    isHost = false,\r\n}) => {\r\n    function generateRandomGrid(): (\"\" | \"!\" | \"?\")[][] {\r\n        const size = 5;\r\n        const totalCells = size * size; // 25\r\n        const symbols = [\"\", \"!\", \"?\"] as const;\r\n\r\n        // Assign counts of 8, 8, 9 to symbols randomly\r\n        const counts = [8, 8, 9];\r\n        // Shuffle counts\r\n        for (let i = counts.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [counts[i], counts[j]] = [counts[j], counts[i]];\r\n        }\r\n\r\n        // Create symbol array\r\n        let symbolArray: (\"\" | \"!\" | \"?\")[] = [];\r\n        for (let i = 0; i < symbols.length; i++) {\r\n            for (let j = 0; j < counts[i]; j++) {\r\n                symbolArray.push(symbols[i]);\r\n            }\r\n        }\r\n\r\n        // Shuffle array\r\n        for (let i = symbolArray.length - 1; i > 0; i--) {\r\n            const j = Math.floor(Math.random() * (i + 1));\r\n            [symbolArray[i], symbolArray[j]] = [symbolArray[j], symbolArray[i]];\r\n        }\r\n\r\n        // Create 5x5 grid, replace undefined/null with \"\"\r\n        let grid: (\"\" | \"!\" | \"?\")[][] = [];\r\n        let index = 0;\r\n        for (let i = 0; i < size; i++) {\r\n            let row: (\"\" | \"!\" | \"?\")[] = [];\r\n            for (let j = 0; j < size; j++) {\r\n                const value = index < symbolArray.length ? symbolArray[index++] : \"\";\r\n                row.push(value);\r\n            }\r\n            grid.push(row);\r\n        }\r\n\r\n        // Ensure each row has at least one \"!\" or \"?\"\r\n        for (let i = 0; i < size; i++) {\r\n            const hasNonEmpty = grid[i].some(cell => cell === \"!\" || cell === \"?\");\r\n            if (!hasNonEmpty) {\r\n                // Find a row with multiple \"!\" or \"?\" to swap\r\n                let donorRow = -1;\r\n                let donorCol = -1;\r\n                for (let r = 0; r < size; r++) {\r\n                    if (r === i) continue;\r\n                    const nonEmptyCount = grid[r].filter(cell => cell === \"!\" || cell === \"?\").length;\r\n                    if (nonEmptyCount > 1) {\r\n                        for (let c = 0; c < size; c++) {\r\n                            if (grid[r][c] === \"!\" || grid[r][c] === \"?\") {\r\n                                donorRow = r;\r\n                                donorCol = c;\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (donorRow !== -1) break;\r\n                    }\r\n                }\r\n\r\n                if (donorRow !== -1) {\r\n                    // Swap with an empty cell in the target row\r\n                    for (let c = 0; c < size; c++) {\r\n                        if (grid[i][c] === \"\") {\r\n                            [grid[i][c], grid[donorRow][donorCol]] = [grid[donorRow][donorCol], grid[i][c]];\r\n                            break;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Place \"!\" in an empty cell and adjust elsewhere\r\n                    for (let c = 0; c < size; c++) {\r\n                        if (grid[i][c] === \"\") {\r\n                            grid[i][c] = \"!\";\r\n                            // Replace a \"!\" elsewhere with \"\"\r\n                            for (let r = 0; r < size; r++) {\r\n                                if (r === i) continue;\r\n                                for (let c2 = 0; c2 < size; c2++) {\r\n                                    if (grid[r][c2] === \"!\") {\r\n                                        grid[r][c2] = \"\";\r\n                                        break;\r\n                                    }\r\n                                }\r\n                                if (grid[r].some(cell => cell === \"\")) break;\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Verify counts (8, 8, 9)\r\n        const finalCounts: Record<\"\" | \"!\" | \"?\", number> = { \"\": 0, \"!\": 0, \"?\": 0 };\r\n        for (const row of grid) {\r\n            for (const cell of row) {\r\n                finalCounts[cell]++;\r\n            }\r\n        }\r\n        const countValues = Object.values(finalCounts).sort((a, b) => a - b);\r\n        if (countValues[0] !== 8 || countValues[1] !== 8 || countValues[2] !== 9) {\r\n            // Adjust counts by swapping to achieve 8, 8, 9\r\n            let targetCounts: Record<\"\" | \"!\" | \"?\", number> = { \"\": 8, \"!\": 8, \"?\": 9 };\r\n            // Randomly assign 8, 8, 9 to symbols\r\n            const tempCounts = [8, 8, 9];\r\n            const tempSymbols = [...symbols];\r\n            for (let i = tempCounts.length - 1; i >= 0; i--) {\r\n                const j = Math.floor(Math.random() * (i + 1));\r\n                targetCounts[tempSymbols[j]] = tempCounts[i];\r\n                tempSymbols.splice(j, 1);\r\n            }\r\n\r\n            // Adjust grid to match target counts\r\n            for (let i = 0; i < size; i++) {\r\n                for (let j = 0; j < size; j++) {\r\n                    if (finalCounts[grid[i][j]] > targetCounts[grid[i][j]]) {\r\n                        // Find a cell to swap with a symbol that needs more\r\n                        for (const sym of symbols) {\r\n                            if (finalCounts[sym] < targetCounts[sym]) {\r\n                                grid[i][j] = sym;\r\n                                finalCounts[grid[i][j]]--;\r\n                                finalCounts[sym]++;\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return grid;\r\n    }\r\n    const handleSuffleGrid = () => {\r\n        console.log(\"start generating grid\");\r\n\r\n        const newGrid = generateRandomGrid()\r\n        console.log(\"newGrid\", newGrid);\r\n\r\n        setGrid(newGrid)\r\n        setInitialGrid(newGrid)\r\n    }\r\n\r\n    const colorMap: Record<string, string> = {\r\n        red: '#FF0000',\r\n        green: '#00FF00',\r\n        blue: '#0000FF',\r\n        yellow: '#FFFF00',\r\n    };\r\n\r\n    const [grid, setGrid] = useState<string[][]>([[]])\r\n    const sounds = useSounds();\r\n    const { startTimer, timeLeft, setTimeLeft } = useTimeStart();\r\n    const [selectedQuestion, setSelectedQuestion] = useState<string | null>(null);\r\n    const [currentQuestion, setCurrentQuestion] = useState<string>(\"\")\r\n    const [correctAnswer, setCorrectAnswer] = useState<string>(\"\")\r\n    const [gridColors, setGridColors] = useState<string[][]>(\r\n        Array(5).fill(null).map(() => Array(5).fill('#FFFFFF')) // Default grid colors are white\r\n    );\r\n    const [menu, setMenu] = useState<{\r\n        visible: boolean;\r\n        rowIndex?: number;\r\n        colIndex?: number;\r\n    }>({ visible: false });\r\n    const [selectedCell, setSelectedCell] = useState<{ row: number; col: number } | null>(null);\r\n    const menuRef = useRef<HTMLDivElement>(null);\r\n    const [searchParams] = useSearchParams()\r\n    const roomId = searchParams.get(\"roomId\") || \"4\"\r\n    const { setEasyQuestionNumber, setMediumQuestionNumber, setHardQuestionNumber, setLevel, animationKey, setAnimationKey, setInitialGrid } = usePlayer()\r\n    const [buzzedPlayer, setBuzzedPlayer] = useState<string>(\"\");\r\n    const [staredPlayer, setStaredPlayer] = useState<string>(\"\");\r\n    const [showModal, setShowModal] = useState(false); // State for modal visibility\r\n    const isInitialTimerMount = useRef(false)\r\n    useGameListeners({\r\n        roomId,\r\n        setBuzzedPlayer,\r\n        setStaredPlayer,\r\n        setShowModal,\r\n        setCorrectAnswer,\r\n        setCurrentQuestion,\r\n        setGridColors,\r\n        setSelectedCell,\r\n        sounds,\r\n        round: \"4\",\r\n        startTimer\r\n    }\r\n    )\r\n\r\n    useEffect(() => {\r\n        if (initialGrid) {\r\n            setGrid(initialGrid)\r\n            setInitialGrid(initialGrid)\r\n        }\r\n    }, [])\r\n    useEffect(() => {\r\n        console.log(\"timeLeft\", timeLeft);\r\n        if (isInitialTimerMount.current) {\r\n            isInitialTimerMount.current = false;\r\n            return;\r\n        }\r\n        if (timeLeft === 0) {\r\n            setAnimationKey((prev: number) => prev + 1);\r\n        }\r\n    }, [timeLeft]);\r\n\r\n    // const isInitialMount = useRef(false)\r\n    // useEffect(() => {\r\n    //     const unsubscribe = listenToTimeStart(roomId, async () => {\r\n\r\n\r\n    //         // Skip the timer setting on the first mount, but allow future calls to run\r\n    //         if (isInitialMount.current) {\r\n    //             isInitialMount.current = false;\r\n    //             return;\r\n    //         }\r\n    //         startTimer(15)\r\n    //         return () => {\r\n    //             unsubscribe();\r\n\r\n    //         };\r\n    //     })\r\n\r\n    // }, [])\r\n\r\n    const handleCloseModal = () => {\r\n        setShowModal(false);\r\n        // Optionally clear buzzedPlayer if you want to reset it\r\n        setBuzzedPlayer(\"\");\r\n\r\n        if (isHost) {\r\n            resetBuzz(roomId)\r\n        }\r\n    };\r\n    // Function to handle cell click (only for host)\r\n    const handleCellClick = (row: number, col: number) => {\r\n        if (!isHost) return; // Prevent non-host users from interacting\r\n        setMenu({\r\n            visible: true,\r\n            rowIndex: row,\r\n            colIndex: col,\r\n        });\r\n    };\r\n\r\n    // Function to handle menu actions\r\n    const handleMenuAction = (action: 'select' | 'red' | 'green' | 'blue' | 'yellow', row: number, col: number) => {\r\n        if (action === 'select') {\r\n            if (initialGrid[row][col] == \"\") {\r\n\r\n                setLevel(\"Dễ\")\r\n            }\r\n\r\n            if (initialGrid[row][col] == \"!\") {\r\n\r\n                setLevel(\"Trung bình\")\r\n            }\r\n\r\n            if (initialGrid[row][col] == \"?\") {\r\n\r\n                setLevel(\"Khó\")\r\n            }\r\n\r\n            sendSelectedCell(roomId, col.toString(), row.toString())\r\n            const questionIndex = row * 5 + col; // Calculate question index from grid position\r\n            if (questions[questionIndex]) {\r\n                setSelectedQuestion(questions[questionIndex]);\r\n                setGridColors((prev) => {\r\n                    const newGrid = prev.map((rowArray) => [...rowArray]);\r\n                    // Reset the previously selected cell to white, if it exists and wasn't colored otherwise\r\n                    if (selectedCell) {\r\n                        const { row: prevRow, col: prevCol } = selectedCell;\r\n                        // Only reset if the cell is still light yellow (i.e., not changed by color buttons)\r\n                        if (newGrid[prevRow][prevCol] === '#FFFF99') {\r\n                            newGrid[prevRow][prevCol] = '#FFFFFF';\r\n                        }\r\n                    }\r\n                    // Set the current cell to light yellow\r\n                    newGrid[row][col] = '#FFFF99'; // Light yellow\r\n                    return newGrid;\r\n                });\r\n                // Update the selected cell\r\n                setSelectedCell({ row, col });\r\n            }\r\n        } else {\r\n            sendCellColor(roomId, col.toString(), row.toString(), action)\r\n            // Set the cell color based on the selected action\r\n\r\n            setGridColors((prev) => {\r\n                const newGrid = prev.map((rowArray) => [...rowArray]);\r\n                newGrid[row][col] = colorMap[action];\r\n                return newGrid;\r\n            });\r\n\r\n            setGridColors((prev) => {\r\n                const newGrid = prev.map((rowArray) => [...rowArray]);\r\n                newGrid[row][col] = colorMap[action];\r\n                return newGrid;\r\n            });\r\n            // If the cell was previously selected, clear the selection\r\n            if (selectedCell && selectedCell.row === row && selectedCell.col === col) {\r\n                setSelectedCell(null);\r\n            }\r\n        }\r\n        setMenu({ visible: false }); // Close the menu\r\n    };\r\n    const lastBuzzedPlayerRef = useRef<string | null>(null);\r\n\r\n\r\n    useEffect(() => {\r\n        const handleClickOutside = (event: MouseEvent) => {\r\n            if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n                setMenu({ visible: false });\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center bg-slate-800/80 backdrop-blur-sm rounded-2xl border border-blue-400/30 shadow-2xl p-6 mb-4 w-full max-w-3xl mx-auto min-h-[470px]\">\r\n            {/* Display selected question */}\r\n            <h2 className=\"text-2xl font-bold text-cyan-200 mb-2 text-center drop-shadow\">\r\n                {currentQuestion || \"\"}\r\n            </h2>\r\n            {correctAnswer && (\r\n                <h2 className=\"text-xl font-semibold text-green-300 mb-4 text-center drop-shadow\">\r\n                    {correctAnswer}\r\n                </h2>\r\n            )}\r\n\r\n            <GameGrid\r\n                initialGrid={grid}\r\n                gridColors={gridColors}\r\n                menu={menu}\r\n                isHost={true}\r\n                isSpectator={isSpectator}\r\n                showModal={showModal}\r\n                buzzedPlayer={buzzedPlayer}\r\n                staredPlayer={staredPlayer}\r\n                menuRef={menuRef}\r\n                onCellClick={handleCellClick}\r\n                onMenuAction={handleMenuAction}\r\n                onCloseModal={handleCloseModal}\r\n            />\r\n\r\n\r\n            <div className=\"flex gap-2 mt-4 w-full\">\r\n                <button\r\n                    onClick={() => {\r\n                        handleSuffleGrid()\r\n                    }}\r\n                    className=\"bg-indigo-600 hover:bg-indigo-700 text-white p-2 flex-1 rounded-md whitespace-nowrap\"\r\n                >\r\n                    Xáo trộn hàng ngang\r\n                </button>\r\n            </div>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default HostQuestionBoxRound4;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}